---
title: Songs
layout: empty
permalink: /songs/
---

{% if page.url == "/songs/" %}
<div class="flex flex-col m-2 px2-2 py-4 rounded-lg" lv-sr-box>
    <b class="text-2xl text-center">테스트</h4>
</div>
{% endif %}

{% if page.url == "/songs/edit" %}
<div class="flex flex-col m-2 px2-2 py-4 rounded-lg" lv-sr-box>
    <div>
        <label for="srTitle" class="block text-sm font-medium leading-6 text-gray-900">제목</label>
        <input type="text" name="srTitle" class="block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900" />
    </div>
    <div>
        <label for="srContent" class="block text-sm font-medium leading-6 text-gray-900">내용</label>
        <textarea id="about" name="about" rows="3"
            class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"></textarea>
    </div>
</div>
{% endif %}

<script type="text/javascript">
    $(() => {
        const isUuid = !!location.search
        const uuid = isUuid ? location.search.substring(1) : crypto.randomUUID()
        if (!isUuid) {
            location.search = `?${uuid}`
        }
        const config = JSON.parse(localStorage.getItem('SR_DATA')) || {}

        const toon = {
            payload: '',
            socket: null,
            async get() {
                const url = `https://toon.at/widget/alertbox/${config.TOON_KEY}`
                const res = await fetch(`https://corsproxy.io/?${encodeURIComponent(url)}`)
                const html = await res.text()

                this.payload = this.parse(html)
                if (this.payload) {
                    this.socket = new WebSocket(`wss://toon.at:8071/${this.payload}`)
                }
                else {
                    toast('투네이션 페이로드를 찾을 수 없습니다.')
                }
                // const iframe = document.createElement('iframe')
                // iframe.id = 'toon'
                // iframe.src = `https://toon.at/widget/alertbox/${config.TOON_KEY}`
                // document.body.append(iframe)
                // console.log(res.body())
            },
            parse(data) {
                const regex = /"payload":"(.*)",/
                if (regex.test(data)) {
                    console.log(regex.exec(data))
                    return regex.exec(data)[1]
                }
                return null
            },
        }

        if (config.TOON_KEY) {
            toon.get()
        }
    })
</script>